{{ $var := .Scratch }}

{{ with where .Pages ".Params.type" "pencil" }}
  {{ range . }}
    {{ if .Params.geo }}
      {{ if not (in ($var.Get "all-geo-ids") .Params.geo) }}
        {{ $var.Add "all-geo-ids" (slice .Params.geo)}}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}

"geoIds": [
{{ with ($var.Get "all-geo-ids") }}
  {{ $total := len . }}
  {{ $len := sub $total 1 }}
  {{ range $i, $e := . }}
    "{{.}}"{{ if lt $i  $len }}, {{ end }}
  {{ end }}
{{ end }}]
